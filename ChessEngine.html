<!DOCTYPE html>
<html>
<canvas id="Canvas" width="400px" height="400px"></canvas>

<body>
    <script>
        var IsPossibleMove = 0;
        var PlayersMovePosition = 0;
        var PlayersMove = [];
        var KingWhiteRookMoved = 0;
        var QueenWhiteRookMoved = 0;
        var KingBlackRookMoved = 0;
        var QueenBlackRookMoved = 0;
        var WhiteKingMoved = 0;
        var BlackKingMoved = 0;
        var passanttile = -1;
        var turn = 0;
        var iteration = 0;
        var x = 0;
        var y = 0;
        document.onmousedown = MouseDown;
        var color1 = "rgb(127,63,0)";
        var color2 = "rgb(63,63,63)";
        var c = document.getElementById("Canvas");
        var ctx = c.getContext("2d");
        ctx.font = "12px Arial";
        var positions = [];
        var possiblemoves = [];

        function resetboard() {
            possiblemoves = [];
            positions = [];
            while (positions.length < 64) {
                positions.push(0);
            }
            positions[0] = -5;
            positions[1] = -3;
            positions[2] = -3.1;
            positions[3] = -9;
            positions[4] = -500;
            positions[5] = -3.1;
            positions[6] = -3;
            positions[7] = -5;
            positions[8] = -1;
            positions[9] = -1;
            positions[10] = -1;
            positions[11] = -1;
            positions[12] = -1;
            positions[13] = -1;
            positions[14] = -1;
            positions[15] = -1;
            positions[56] = 5;
            positions[57] = 3;
            positions[58] = 3.1;
            positions[59] = 9;
            positions[60] = 500;
            positions[61] = 3.1;
            positions[62] = 3;
            positions[63] = 5;
            positions[48] = 1;
            positions[49] = 1;
            positions[50] = 1;
            positions[51] = 1;
            positions[52] = 1;
            positions[53] = 1;
            positions[54] = 1;
            positions[55] = 1;
            WhiteKingMoved = 0;
            KingWhiteRookMoved = 0;
            QueenWhiteRookMoved = 0;
            passanttile = -1;
            turn = 0;
            iteration = 0;
            KingBlackRookMoved = 0;
            QueenBlackRookMoved = 0;
            PlayersMove = [];
        }
        resetboard();

        function drawboard() {
            for (var i = 0; i < 64; i++) {
                if (i % 2 === 0) {
                    if (Math.floor(i / 8) % 2 === 0) {
                        color1 = "rgb(63,63,63)";
                        color2 = "rgb(127,63,0)";
                    } else {
                        color1 = "rgb(127,63,0)";
                        color2 = "rgb(63,63,63)";
                    }
                    ctx.fillStyle = color1;
                } else {
                    ctx.fillStyle = color2;
                }
                ctx.fillRect((i % 8) * 50, (Math.floor(i / 8)) * 50, 50, 50);
            }
            for (var j = 0; j <= 63; j++) {
                if (positions[j] === 1) {
                    ctx.fillStyle = "rgb(255,255,255)";
                    ctx.fillText("P", (j % 8) * 50 + 22, Math.floor(j / 8) * 50 + 30);
                } else if (positions[j] === -1) {
                    ctx.fillStyle = "rgb(0,0,0)";
                    ctx.fillText("P", (j % 8) * 50 + 22, Math.floor(j / 8) * 50 + 30);
                } else if (positions[j] === -3) {
                    ctx.fillStyle = "rgb(0,0,0)";
                    ctx.fillText("N", (j % 8) * 50 + 22, Math.floor(j / 8) * 50 + 30);
                } else if (positions[j] === 3) {
                    ctx.fillStyle = "rgb(255,255,255)";
                    ctx.fillText("N", (j % 8) * 50 + 22, Math.floor(j / 8) * 50 + 30);
                } else if (positions[j] === -3.1) {
                    ctx.fillStyle = "rgb(0,0,0)";
                    ctx.fillText("B", (j % 8) * 50 + 22, Math.floor(j / 8) * 50 + 30);
                } else if (positions[j] === 3.1) {
                    ctx.fillStyle = "rgb(255,255,255)";
                    ctx.fillText("B", (j % 8) * 50 + 22, Math.floor(j / 8) * 50 + 30);
                } else if (positions[j] === -5) {
                    ctx.fillStyle = "rgb(0,0,0)";
                    ctx.fillText("R", (j % 8) * 50 + 22, Math.floor(j / 8) * 50 + 30);
                } else if (positions[j] === 5) {
                    ctx.fillStyle = "rgb(255,255,255)";
                    ctx.fillText("R", (j % 8) * 50 + 22, Math.floor(j / 8) * 50 + 30);
                } else if (positions[j] === -9) {
                    ctx.fillStyle = "rgb(0,0,0)";
                    ctx.fillText("Q", (j % 8) * 50 + 22, Math.floor(j / 8) * 50 + 30);
                } else if (positions[j] === 9) {
                    ctx.fillStyle = "rgb(255,255,255)";
                    ctx.fillText("Q", (j % 8) * 50 + 22, Math.floor(j / 8) * 50 + 30);
                } else if (positions[j] === -500) {
                    ctx.fillStyle = "rgb(0,0,0)";
                    ctx.fillText("K", (j % 8) * 50 + 22, Math.floor(j / 8) * 50 + 30);
                } else if (positions[j] === 500) {
                    ctx.fillStyle = "rgb(255,255,255)";
                    ctx.fillText("K", (j % 8) * 50 + 22, Math.floor(j / 8) * 50 + 30);
                }
            }
        }
        drawboard();

        function PossibleMovesfun() {
            for (var i = 0; i < 8; i++) {
                if (positions[i] === 1) {
                    positions[i] = 9;
                } else if (positions[i + 56] === -1) {
                    positions[i + 56] = -9;
                }
            }
            for (var i = 0; i < positions.length; i++) {
                if (turn === 0) {
                    if (positions[i] === 500) {
                        if (positions[57] === 0 && positions[58] === 0 && positions[59] === 0 && WhiteKingMoved === 0 && QueenWhiteRookMoved === 0) {
                            possiblemoves.push("WQSC");
                        }
                        if (positions[62] === 0 && positions[61] === 0 && WhiteKingMoved === 0 && KingWhiteRookMoved === 0) {
                            possiblemoves.push("WKSC");
                        }
                        if (positions[i - 8] <= 0) {
                            possiblemoves.push([i, i - 8]);
                        }
                        if (positions[i + 8] <= 0) {
                            possiblemoves.push([i, i + 8]);
                        }
                        if (positions[i + 1] <= 0) {
                            possiblemoves.push([i, i + 1]);
                        }
                        if (positions[i - 1] <= 0) {
                            possiblemoves.push([i, i - 1]);
                        }
                        if (positions[i - 7] <= 0 && Math.abs((i % 8) - ((i - 7) % 8)) < 2 && Math.abs((i % 8) - ((i - 7) % 8)) > 0) {
                            possiblemoves.push([i, i - 7]);
                        }
                        if (positions[i - 9] <= 0 && Math.abs((i % 8) - ((i - 9) % 8)) > 0 && Math.abs((i % 8) - ((i - 9) % 8)) < 2) {
                            possiblemoves.push([i, i - 9]);
                        }
                        if (positions[i + 9] <= 0 && Math.abs((i % 8) - ((i + 9) % 8)) > 0 && Math.abs((i % 8) - ((i + 9) % 8)) < 2) {
                            possiblemoves.push([i, i + 9]);
                        }
                        if (positions[i + 7] <= 0 && Math.abs((i % 8) - ((i + 7) % 8)) < 2 && Math.abs((i % 8) - ((i + 7) % 8)) > 0) {
                            possiblemoves.push([i, i + 7]);
                        }
                    }
                    if (positions[i] === 9) {
                        for (var j = 9; j < 72; j += 9) {
                            if ((i - j) % 8 === 0 || i - j < 0 || i - j > 63 || (i - j) % 8 === 7) {
                                j = 72;
                            }
                            if (positions[i - j] === 0 && j != null) {
                                possiblemoves.push([i, i - j]);
                            } else if (j != null && positions[i - j] < 0) {
                                possiblemoves.push([i, i - j]);
                                j = 72;
                            } else if (j != null && positions[i - j] > 0) {
                                j = 72;
                            }
                        }
                        for (var j = 9; j < 72; j += 9) {
                            if ((i + j) % 8 === 0 || i + j < 0 || i + j > 63 || (i + j) % 8 === 7) {
                                j = 72;
                            }
                            if (positions[i + j] === 0 && j != null) {
                                possiblemoves.push([i, i + j]);
                            } else if (j != null && positions[i + j] < 0) {
                                possiblemoves.push([i, i + j]);
                                j = 72;
                            } else if (j != null && positions[i + j] > 0) {
                                j = 72;
                            }
                        }
                        for (var j = 7; j < 56; j += 7) {
                            if ((i - j) % 8 === 0 || i - j < 0 || i - j > 63 || (i - j) % 8 === 7) {
                                j = 99;
                            }
                            if (positions[i - j] === 0 && j != null) {
                                possiblemoves.push([i, i - j]);
                            } else if (j != null && positions[i - j] < 0) {
                                possiblemoves.push([i, i - j]);
                                j = 99;
                            } else if (j != null && positions[i - j] > 0) {
                                j = 99;
                            }
                        }
                        for (var j = 7; j < 56; j += 7) {
                            if ((i + j) % 8 === 0 || i + j < 0 || i + j > 63 || (i + j) % 8 === 7) {
                                j = 99;
                            }
                            if (positions[i + j] === 0 && j != null) {
                                possiblemoves.push([i, i + j]);
                            } else if (j != null && positions[i + j] < 0) {
                                possiblemoves.push([i, i + j]);
                                j = 99;
                            } else if (j != null && positions[i + j] > 0) {
                                j = 99;
                            }
                        }
                        for (var j = 1; j < 8; j++) {
                            if (positions[i - j] === 0 && j !== null && Math.floor(i / 8) === Math.floor((i - j) / 8)) {
                                possiblemoves.push([i, i - j]);
                            } else if (j != null && positions[i - j] < 0 && Math.floor(i / 8) === Math.floor((i - j) / 8)) {
                                possiblemoves.push([i, i - j]);
                                j = 64;
                            } else if (j != null && positions[i - j] > 0) {
                                j = 64;
                            }
                        }
                        for (var j = 8; j < 64; j += 8) {
                            if (positions[i - j] === 0 && j !== null) {
                                possiblemoves.push([i, i - j]);
                            } else if (j != null && positions[i - j] < 0) {
                                possiblemoves.push([i, i - j]);
                                j = 64;
                            } else if (j != null && positions[i - j] > 0) {
                                j = 64;
                            }
                        }
                        for (var j = 1; j < 8; j++) {
                            if (positions[i + j] === 0 && j !== null && Math.floor(i / 8) === Math.floor((i + j) / 8)) {
                                possiblemoves.push([i, i + j]);
                            } else if (j != null && positions[i + j] < 0 && Math.floor(i / 8) === Math.floor((i + j) / 8)) {
                                possiblemoves.push([i, i + j]);
                                j = 64;
                            } else if (j != null && positions[i + j] > 0) {
                                j = 64;
                            }
                        }
                        for (var j = 8; j < 64; j += 8) {
                            if (positions[i + j] === 0 && j !== null) {
                                possiblemoves.push([i, i + j]);
                            } else if (j != null && positions[i + j] < 0) {
                                possiblemoves.push([i, i + j]);
                                j = 64;
                            } else if (j != null && positions[i + j] > 0) {
                                j = 64;
                            }
                        }
                    }
                    if (positions[i] === 3) {
                        if (i - 17 > 0 && i % 8 != 0) {
                            if (positions[i - 17] <= 0) {
                                possiblemoves.push([i, i - 17]);
                            }
                        }
                        if (i - 15 > 0 && i % 8 != 7) {
                            if (positions[i - 15] <= 0) {
                                possiblemoves.push([i, i - 15]);
                            }
                        }
                        if (i - 10 > 0 && i % 8 != 0 && i % 8 != 1) {
                            if (positions[i - 10] <= 0) {
                                possiblemoves.push([i, i - 10]);
                            }
                        }
                        if (i - 6 > 0 && i % 8 != 7 && i % 8 != 6) {
                            if (positions[i - 6] <= 0) {
                                possiblemoves.push([i, i - 6]);
                            }
                        }
                        if (i + 17 < 63 && i % 8 != 7) {
                            if (positions[i + 17] <= 0) {
                                possiblemoves.push([i, i + 17]);
                            }
                        }
                        if (i + 15 < 63 && i % 8 != 0) {
                            if (positions[i + 15] <= 0) {
                                possiblemoves.push([i, i + 15]);
                            }
                        }
                        if (i + 10 < 63 && i % 8 != 6 && i % 8 != 7) {
                            if (positions[i + 10] <= 0) {
                                possiblemoves.push([i, i + 10]);
                            }
                        }
                        if (i + 6 < 63 && i % 8 != 0 && i % 8 != 1) {
                            if (positions[i + 6] <= 0) {
                                possiblemoves.push([i, i + 6]);
                            }
                        }
                    }
                    if (positions[i] === 3.1) {
                        for (var j = 9; j < 72; j += 9) {
                            if ((i - j) % 8 === 0 || i - j < 0 || i - j > 63 || (i - j) % 8 === 7) {
                                j = 72;
                            }
                            if (positions[i - j] === 0 && j != null) {
                                possiblemoves.push([i, i - j]);
                            } else if (j != null && positions[i - j] < 0) {
                                possiblemoves.push([i, i - j]);
                                j = 72;
                            } else if (j != null && positions[i - j] > 0) {
                                j = 72;
                            }
                        }
                        for (var j = 9; j < 72; j += 9) {
                            if ((i + j) % 8 === 0 || i + j < 0 || i + j > 63 || (i + j) % 8 === 7) {
                                j = 72;
                            }
                            if (positions[i + j] === 0 && j != null) {
                                possiblemoves.push([i, i + j]);
                            } else if (j != null && positions[i + j] < 0) {
                                possiblemoves.push([i, i + j]);
                                j = 72;
                            } else if (j != null && positions[i + j] > 0) {
                                j = 72;
                            }
                        }
                        for (var j = 7; j < 56; j += 7) {
                            if ((i - j) % 8 === 0 || i - j < 0 || i - j > 63 || (i - j) % 8 === 7) {
                                j = 99;
                            }
                            if (positions[i - j] === 0 && j != null) {
                                possiblemoves.push([i, i - j]);
                            } else if (j != null && positions[i - j] < 0) {
                                possiblemoves.push([i, i - j]);
                                j = 99;
                            } else if (j != null && positions[i - j] > 0) {
                                j = 99;
                            }
                        }
                        for (var j = 7; j < 56; j += 7) {
                            if ((i + j) % 8 === 0 || i + j < 0 || i + j > 63 || (i + j) % 8 === 7) {
                                j = 99;
                            }
                            if (positions[i + j] === 0 && j != null) {
                                possiblemoves.push([i, i + j]);
                            } else if (j != null && positions[i + j] < 0) {
                                possiblemoves.push([i, i + j]);
                                j = 99;
                            } else if (j != null && positions[i + j] > 0) {
                                j = 99;
                            }
                        }
                    }
                    if (positions[i] === 5) {
                        for (var j = 1; j < 8; j++) {
                            if (positions[i - j] === 0 && j !== null && Math.floor(i / 8) === Math.floor((i - j) / 8)) {
                                possiblemoves.push([i, i - j]);
                            } else if (j != null && positions[i - j] < 0 && Math.floor(i / 8) === Math.floor((i - j) / 8)) {
                                possiblemoves.push([i, i - j]);
                                j = 64;
                            } else if (j != null && positions[i - j] > 0) {
                                j = 64;
                            }
                        }
                        for (var j = 8; j < 64; j += 8) {
                            if (positions[i - j] === 0 && j !== null) {
                                possiblemoves.push([i, i - j]);
                            } else if (j != null && positions[i - j] < 0) {
                                possiblemoves.push([i, i - j]);
                                j = 64;
                            } else if (j != null && positions[i - j] > 0) {
                                j = 64;
                            }
                        }
                        for (var j = 1; j < 8; j++) {
                            if (positions[i + j] === 0 && j !== null && Math.floor(i / 8) === Math.floor((i + j) / 8)) {
                                possiblemoves.push([i, i + j]);
                            } else if (j != null && positions[i + j] < 0 && Math.floor(i / 8) === Math.floor((i + j) / 8)) {
                                possiblemoves.push([i, i + j]);
                                j = 64;
                            } else if (j != null && positions[i + j] > 0) {
                                j = 64;
                            }
                        }
                        for (var j = 8; j < 64; j += 8) {
                            if (positions[i + j] === 0 && j !== null) {
                                possiblemoves.push([i, i + j]);
                            } else if (j != null && positions[i + j] < 0) {
                                possiblemoves.push([i, i + j]);
                                j = 64;
                            } else if (j != null && positions[i + j] > 0) {
                                j = 64;
                            }
                        }
                    }
                    if (positions[i] === 1) {
                        if (positions[i - 8] === 0) {
                            possiblemoves.push([i, i - 8]);
                        }
                        if (positions[i - 16] === 0 && Math.floor(i / 8) === 6 && positions[i - 8] === 0) {
                            possiblemoves.push([i, i - 16]);
                        }
                        if (positions[i - 7] < 0 && Math.abs((i % 8) - ((i - 7) % 8)) < 2 && Math.abs((i % 8) - ((i - 7) % 8)) > 0) {
                            possiblemoves.push([i, i - 7]);
                        }
                        if (positions[i - 9] < 0 && Math.abs((i % 8) - ((i - 9) % 8)) > 0 && Math.abs((i % 8) - ((i - 9) % 8)) < 2) {
                            possiblemoves.push([i, i - 9]);
                        }
                        if (passanttile === i - 7 && Math.abs((i % 8) - ((i - 7) % 8)) < 2 && Math.abs((i % 8) - ((i - 7) % 8)) > 0) {
                            possiblemoves.push([i, i - 7, 1]);
                        }
                        if (passanttile === i - 9 && Math.abs((i % 8) - ((i - 9) % 8)) > 0 && Math.abs((i % 8) - ((i - 9) % 8)) < 2) {
                            possiblemoves.push([i, i - 9, 2]);
                        }
                    }
                } else {
                    if (positions[i] === -500) {
                        if (positions[1] === 0 && positions[2] === 0 && positions[3] === 0 && BlackKingMoved === 0 && QueenBlackRookMoved === 0) {
                            possiblemoves.push("BQSC");
                        }
                        if (positions[5] === 0 && positions[6] === 0 && BlackKingMoved === 0 && KingBlackRookMoved === 0) {
                            possiblemoves.push("BKSC");
                        }
                        if (positions[i - 8] >= 0) {
                            possiblemoves.push([i, i - 8]);
                        }
                        if (positions[i + 8] >= 0) {
                            possiblemoves.push([i, i + 8]);
                        }
                        if (positions[i + 1] >= 0) {
                            possiblemoves.push([i, i + 1]);
                        }
                        if (positions[i - 1] >= 0) {
                            possiblemoves.push([i, i - 1]);
                        }
                        if (positions[i - 7] >= 0 && Math.abs((i % 8) - ((i - 7) % 8)) < 2 && Math.abs((i % 8) - ((i - 7) % 8)) > 0) {
                            possiblemoves.push([i, i - 7]);
                        }
                        if (positions[i - 9] >= 0 && Math.abs((i % 8) - ((i - 9) % 8)) > 0 && Math.abs((i % 8) - ((i - 9) % 8)) < 2) {
                            possiblemoves.push([i, i - 9]);
                        }
                        if (positions[i + 9] >= 0 && Math.abs((i % 8) - ((i + 9) % 8)) > 0 && Math.abs((i % 8) - ((i + 9) % 8)) < 2) {
                            possiblemoves.push([i, i + 9]);
                        }
                        if (positions[i + 7] >= 0 && Math.abs((i % 8) - ((i + 7) % 8)) < 2 && Math.abs((i % 8) - ((i + 7) % 8)) > 0) {
                            possiblemoves.push([i, i + 7]);
                        }
                    }
                    if (positions[i] === -9) {
                        for (var j = 9; j < 72; j += 9) {
                            if ((i - j) % 8 === 0 || i - j < 0 || i - j > 63 || (i - j) % 8 === 7) {
                                j = 72;
                            }
                            if (positions[i - j] === 0 && j != null) {
                                possiblemoves.push([i, i - j]);
                            } else if (j != null && positions[i - j] > 0) {
                                possiblemoves.push([i, i - j]);
                                j = 72;
                            } else if (j != null && positions[i - j] < 0) {
                                j = 72;
                            }
                        }
                        for (var j = 9; j < 72; j += 9) {
                            if ((i + j) % 8 === 0 || i + j < 0 || i + j > 63 || (i + j) % 8 === 7) {
                                j = 72;
                            }
                            if (positions[i + j] === 0 && j != null) {
                                possiblemoves.push([i, i + j]);
                            } else if (j != null && positions[i - j] > 0) {
                                possiblemoves.push([i, i + j]);
                                j = 72;
                            } else if (j != null && positions[i + j] < 0) {
                                j = 72;
                            }
                        }
                        for (var j = 7; j < 56; j += 7) {
                            if ((i - j) % 8 === 7 || i - j < 0 || i - j > 63 || (i - j) % 8 === 0) {
                                j = 99;
                            }
                            if (positions[i - j] === 0 && j != null) {
                                possiblemoves.push([i, i - j]);
                            } else if (j != null && positions[i - j] > 0) {
                                possiblemoves.push([i, i - j]);
                                j = 99;
                            } else if (j != null && positions[i - j] < 0) {
                                j = 99;
                            }
                        }
                        for (var j = 7; j < 56; j += 7) {
                            if ((i + j) % 8 === 7 || i + j < 0 || i + j > 63 || (i + j) % 8 === 0) {
                                j = 99;
                            }
                            if (positions[i + j] === 0 && j != null) {
                                possiblemoves.push([i, i + j]);
                            } else if (j != null && positions[i + j] > 0) {
                                possiblemoves.push([i, i + j]);
                                j = 99;
                            } else if (j != null && positions[i + j] < 0) {
                                j = 99;
                            }
                        }
                        for (var j = 1; j < 8; j++) {
                            if (positions[i - j] === 0 && j !== null && Math.floor(i / 8) === Math.floor((i - j) / 8)) {
                                possiblemoves.push([i, i - j]);
                            } else if (j != null && positions[i - j] > 0 && Math.floor(i / 8) === Math.floor((i - j) / 8)) {
                                possiblemoves.push([i, i - j]);
                                j = 64;
                            } else if (j != null && positions[i - j] < 0) {
                                j = 64;
                            }
                        }
                        for (var j = 8; j < 64; j += 8) {
                            if (positions[i - j] === 0 && j !== null) {
                                possiblemoves.push([i, i - j]);
                            } else if (j != null && positions[i - j] > 0) {
                                possiblemoves.push([i, i - j]);
                                j = 64;
                            } else if (j != null && positions[i - j] < 0) {
                                j = 64;
                            }
                        }
                        for (var j = 1; j < 8; j++) {
                            if (positions[i + j] === 0 && j !== null && Math.floor(i / 8) === Math.floor((i + j) / 8)) {
                                possiblemoves.push([i, i + j]);
                            } else if (j != null && positions[i + j] > 0 && Math.floor(i / 8) === Math.floor((i + j) / 8)) {
                                possiblemoves.push([i, i + j]);
                                j = 64;
                            } else if (j != null && positions[i + j] < 0) {
                                j = 64;
                            }
                        }
                        for (var j = 8; j < 64; j += 8) {
                            if (positions[i + j] === 0 && j !== null) {
                                possiblemoves.push([i, i + j]);
                            } else if (j != null && positions[i + j] > 0) {
                                possiblemoves.push([i, i + j]);
                                j = 64;
                            } else if (j != null && positions[i + j] < 0) {
                                j = 64;
                            }
                        }
                    }
                    if (positions[i] === -3) {
                        if (i - 17 > 0 && i % 8 != 0) {
                            if (positions[i - 17] >= 0) {
                                possiblemoves.push([i, i - 17]);
                            }
                        }
                        if (i - 15 > 0 && i % 8 != 7) {
                            if (positions[i - 15] >= 0) {
                                possiblemoves.push([i, i - 15]);
                            }
                        }
                        if (i - 10 > 0 && i % 8 != 0 && i % 8 != 1) {
                            if (positions[i - 10] >= 0) {
                                possiblemoves.push([i, i - 10]);
                            }
                        }
                        if (i - 6 > 0 && i % 8 != 7 && i % 8 != 6) {
                            if (positions[i - 6] >= 0) {
                                possiblemoves.push([i, i - 6]);
                            }
                        }
                        if (i + 17 < 63 && i % 8 != 7) {
                            if (positions[i + 17] >= 0) {
                                possiblemoves.push([i, i + 17]);
                            }
                        }
                        if (i + 15 < 63 && i % 8 != 0) {
                            if (positions[i + 15] >= 0) {
                                possiblemoves.push([i, i + 15]);
                            }
                        }
                        if (i + 10 < 63 && i % 8 != 6 && i % 8 != 7) {
                            if (positions[i + 10] >= 0) {
                                possiblemoves.push([i, i + 10]);
                            }
                        }
                        if (i + 6 < 63 && i % 8 != 0 && i % 8 != 1) {
                            if (positions[i + 6] >= 0) {
                                possiblemoves.push([i, i + 6]);
                            }
                        }
                    }
                    if (positions[i] === -3.1) {
                        for (var j = 9; j < 72; j += 9) {
                            if ((i - j) % 8 === 0 || i - j < 0 || i - j > 63 || (i - j) % 8 === 7) {
                                j = 72;
                            }
                            if (positions[i - j] === 0 && j != null) {
                                possiblemoves.push([i, i - j]);
                            } else if (j != null && positions[i - j] > 0) {
                                possiblemoves.push([i, i - j]);
                                j = 72;
                            } else if (j != null && positions[i - j] < 0) {
                                j = 72;
                            }
                        }
                        for (var j = 9; j < 72; j += 9) {
                            if ((i + j) % 8 === 0 || i + j < 0 || i + j > 63 || (i + j) % 8 === 7) {
                                j = 72;
                            }
                            if (positions[i + j] === 0 && j != null) {
                                possiblemoves.push([i, i + j]);
                            } else if (j != null && positions[i - j] > 0) {
                                possiblemoves.push([i, i + j]);
                                j = 72;
                            } else if (j != null && positions[i + j] < 0) {
                                j = 72;
                            }
                        }
                        for (var j = 7; j < 56; j += 7) {
                            if ((i - j) % 8 === 7 || i - j < 0 || i - j > 63 || (i - j) % 8 === 0) {
                                j = 99;
                            }
                            if (positions[i - j] === 0 && j != null) {
                                possiblemoves.push([i, i - j]);
                            } else if (j != null && positions[i - j] > 0) {
                                possiblemoves.push([i, i - j]);
                                j = 99;
                            } else if (j != null && positions[i - j] < 0) {
                                j = 99;
                            }
                        }
                        for (var j = 7; j < 56; j += 7) {
                            if ((i + j) % 8 === 7 || i + j < 0 || i + j > 63 || (i + j) % 8 === 0) {
                                j = 99;
                            }
                            if (positions[i + j] === 0 && j != null) {
                                possiblemoves.push([i, i + j]);
                            } else if (j != null && positions[i + j] > 0) {
                                possiblemoves.push([i, i + j]);
                                j = 99;
                            } else if (j != null && positions[i + j] < 0) {
                                j = 99;
                            }
                        }
                    }
                    if (positions[i] === -5) {
                        for (var j = 1; j < 8; j++) {
                            if (positions[i - j] === 0 && j !== null && Math.floor(i / 8) === Math.floor((i - j) / 8)) {
                                possiblemoves.push([i, i - j]);
                            } else if (j != null && positions[i - j] > 0 && Math.floor(i / 8) === Math.floor((i - j) / 8)) {
                                possiblemoves.push([i, i - j]);
                                j = 64;
                            } else if (j != null && positions[i - j] < 0) {
                                j = 64;
                            }
                        }
                        for (var j = 8; j < 64; j += 8) {
                            if (positions[i - j] === 0 && j !== null) {
                                possiblemoves.push([i, i - j]);
                            } else if (j != null && positions[i - j] > 0) {
                                possiblemoves.push([i, i - j]);
                                j = 64;
                            } else if (j != null && positions[i - j] < 0) {
                                j = 64;
                            }
                        }
                        for (var j = 1; j < 8; j++) {
                            if (positions[i + j] === 0 && j !== null && Math.floor(i / 8) === Math.floor((i + j) / 8)) {
                                possiblemoves.push([i, i + j]);
                            } else if (j != null && positions[i + j] > 0 && Math.floor(i / 8) === Math.floor((i + j) / 8)) {
                                possiblemoves.push([i, i + j]);
                                j = 64;
                            } else if (j != null && positions[i + j] < 0) {
                                j = 64;
                            }
                        }
                        for (var j = 8; j < 64; j += 8) {
                            if (positions[i + j] === 0 && j !== null) {
                                possiblemoves.push([i, i + j]);
                            } else if (j != null && positions[i + j] > 0) {
                                possiblemoves.push([i, i + j]);
                                j = 64;
                            } else if (j != null && positions[i + j] < 0) {
                                j = 64;
                            }
                        }
                    }
                    if (positions[i] === -1) {
                        if (positions[i + 8] === 0) {
                            possiblemoves.push([i, i + 8]);
                        }
                        if (positions[i + 16] === 0 && Math.floor(i / 8) === 1 && positions[i + 8] === 0) {
                            possiblemoves.push([i, i + 16]);
                        }
                        if (positions[i + 7] > 0 && Math.abs((i % 8) - ((i + 7) % 8)) < 2 && Math.abs((i % 8) - ((i + 7) % 8)) > 0) {
                            possiblemoves.push([i, i + 7]);

                        }
                        if (positions[i + 9] > 0 && Math.abs((i % 8) - ((i + 9) % 8)) > 0 && Math.abs((i % 8) - ((i + 9) % 8)) < 2) {
                            possiblemoves.push([i, i + 9]);

                        }
                        if (passanttile === i + 7 && Math.abs((i % 8) - ((i + 7) % 8)) < 2 && Math.abs((i % 8) - ((i + 7) % 8)) > 0) {
                            possiblemoves.push([i, i + 7, 3]);
                        }
                        if (passanttile === i + 9 && Math.abs((i % 8) - ((i + 9) % 8)) > 0 && Math.abs((i % 8) - ((i + 9) % 8)) < 2) {
                            possiblemoves.push([i, i + 9, 4]);
                        }
                    }
                }
            }
            //console.log(possiblemoves);
        }
        PossibleMovesfun();

        function ChooseMove() {
          	IsPossibleMove = 0;
            var hideousvariable = null;
            //var hideousvariable = Math.round(Math.random() * (possiblemoves.length - 1));
            for (var i = 0; i < possiblemoves.length; i++) {
                if (PlayersMove[0] === possiblemoves[i][0] && PlayersMove[1] === possiblemoves[i][1] && PlayersMove[2] === possiblemoves[i][2]) {
                    IsPossibleMove = 1;
                }
              console.log(PlayersMove," ",possiblemoves[i]);
            }
            if (PlayersMove.length > 1 && IsPossibleMove === 1) {
              	hideousvariable = -1;
                possiblemoves[hideousvariable] = PlayersMove;
            }
            if (hideousvariable != null) {
								if (turn === 1) {
                    turn = 0;
                } else {
                    turn = 1;
                }
                if (possiblemoves.length > 0) {
                    if (possiblemoves[hideousvariable] === "WKSC") {
                        positions[61] = 5;
                        positions[62] = 500;
                        positions[63] = 0;
                        positions[60] = 0;
                        WhiteKingMoved = 1;
                    }
                    if (possiblemoves[hideousvariable] === "WQSC") {
                        positions[59] = 5;
                        positions[58] = 500;
                        positions[56] = 0;
                        positions[60] = 0;
                        WhiteKingMoved = 1;
                    }
                    if (possiblemoves[hideousvariable] === "BQSC") {
                        positions[3] = -5;
                        positions[2] = -500;
                        positions[0] = 0;
                        positions[4] = 0;
                        BlackKingMoved = 1;
                    }
                    if (possiblemoves[hideousvariable] === "BKSC") {
                        positions[5] = -5;
                        positions[6] = -500;
                        positions[4] = 0;
                        positions[7] = 0;
                        BlackKingMoved = 1;
                    }
                    if (positions[possiblemoves[hideousvariable][0]] === 500) {
                        WhiteKingMoved = 1;
                    }
                    if (possiblemoves[hideousvariable].length === 3) {
                        if (possiblemoves[hideousvariable][2] === 1) {
                            positions[possiblemoves[hideousvariable][1] + 8] = 0
                        }
                        if (possiblemoves[hideousvariable][2] === 2) {
                            positions[possiblemoves[hideousvariable][1] + 8] = 0
                        }
                        if (possiblemoves[hideousvariable][2] === 3) {
                            positions[possiblemoves[hideousvariable][1] - 8] = 0
                        }
                        if (possiblemoves[hideousvariable][2] === 4) {
                            positions[possiblemoves[hideousvariable][1] - 8] = 0
                        }
                    }
            				//if (passanttile != -1) {
                				//passanttile = -1;
            				//}
                  	if (Math.abs(positions[possiblemoves[hideousvariable][0]]) === 1 && Math.abs(possiblemoves[hideousvariable][0] - possiblemoves[hideousvariable][1]) === 16) {if (positions[possiblemoves[hideousvariable][0]] > 0) {passanttile = possiblemoves[hideousvariable][1]+8;} else if (positions[possiblemoves[hideousvariable][0]] < 0) {passanttile = possiblemoves[hideousvariable][1]-8;}}
                  	console.log(passanttile);
                    positions[possiblemoves[hideousvariable][1]] = positions[possiblemoves[hideousvariable][0]];
                    positions[possiblemoves[hideousvariable][0]] = 0;
                    if (positions[63] != 5) {
                        KingWhiteRookMoved = 1;
                    }
                }
                drawboard();
                possiblemoves = [];
            }
        }

        function MousePosition(event) {
            event = event || window.event;
            x = event.clientX - 8;
            y = event.clientY - 8;
        }

        function MouseDown() {
            PossibleMovesfun();
            iteration++;
            MousePosition();
            ctx.fillStyle = "rgba(63,255,63,0.5)";
            ctx.fillRect(Math.floor(x / 50) * 50, Math.floor(y / 50) * 50, 50, 50);
            PlayersMove.push(Math.floor((x / 50)) + Math.floor((y / 50)) * 8);

            if (iteration === 2) {
                if (PlayersMove[0] === 60 && PlayersMove[1] === 62) {
                    PlayersMove = "WKSC";
                }
                if (PlayersMove[0] === 60 && PlayersMove[1] === 58) {
                    PlayersMove = "WQSC";
                }
                if (PlayersMove[0] === 4 && PlayersMove[1] === 6) {
                    PlayersMove = "BKSC";
                }
                if (PlayersMove[0] === 4 && PlayersMove[1] === 2) {
                    PlayersMove = "BQSC";
                }
                if (PlayersMove[1] === passanttile && PlayersMove[0] === (PlayersMove[1] - 7)) {
                    PlayersMove = [PlayersMove[0], PlayersMove[1], 3];
                }
                if (PlayersMove[1] === passanttile && PlayersMove[0] === (PlayersMove[1] - 9)) {
                    PlayersMove = [PlayersMove[0], PlayersMove[1], 4];
                }
                if (PlayersMove[1] === passanttile && PlayersMove[0] === (PlayersMove[1] + 7)) {
                    PlayersMove = [PlayersMove[0], PlayersMove[1], 1];
                }
                if (PlayersMove[1] === passanttile && PlayersMove[0] === (PlayersMove[1] + 9)) {
                    PlayersMove = [PlayersMove[0], PlayersMove[1], 2];
                }
                ChooseMove();
                PlayersMove = [];
                drawboard();
                iteration = 0;
            }
        }
    </script>
</body>

</html>
